(function() {
  var checkForErrorFormatter, moment;

  moment = require('moment');

  module.exports = function(lib, eformatter) {
    var cucumber, execOptions, timeStart;
    timeStart = new Date().getTime();
    execOptions = process.argv || [];
    if (!process.argv.filter(checkForErrorFormatter).length) {
      execOptions.push("--error_formatter=" + eformatter);
    }
    execOptions.push("--require");
    execOptions.push("" + lib + "/support");
    require('./environment')();
    cucumber = require('cucumber');
    return cucumber.Cli(execOptions).run(function() {
      var testTime;
      testTime = moment.duration(new Date().getTime() - timeStart)._data;
      return console.log("Duration " + "(" + testTime.minutes + "m:" + testTime.seconds + "s:" + testTime.milliseconds + "ms)");
    });
  };

  checkForErrorFormatter = function(element) {
    return !element.indexOf('--error_formatter');
  };

}).call(this);
